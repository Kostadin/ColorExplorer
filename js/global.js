var fps = 30;
var colorCount = 4;
var screenWidth = 1024;
var screenHeight = 600;
var screenOriginX = 0;
var screenOriginY = 0;
var levels = [];
var currentLevel = null;
var gameRunning = false;
var colors=['red','yellow','green','blue'];
var colorBackgrounds=["url('img/platforms/red.png')","url('img/platforms/yellow.png')","url('img/platforms/green.png')","url('img/platforms/blue.png')"];
var currentColor = 0;
var currentColorCSS = colors[currentColor];
var muteSound = false;
var playerFacing = "right";
var playerDivOffsetX = -40;
var playerDivOffsetY = -20;
var parallaxRatio = 3;
//Animation counter
var animationFrame = 0;
var gameFrame = 0;
var animationRatio = 3;
//Brick types
var platform = 0;
var platformWidth = 134;
var platformHeight = 54;
var platformDivOffsetY = -10;
var portal = 1;
var portalHeight = 60;
var portalWidth = 164;
var leftPressed = false;
var rightPressed = false;
var upPressed = false;
var currentTry = 0;
var maxTries = 3;
var deadAnimationHandle = null;
var winAnimationHandle = null;
var currentLevelIndex = 0;
var deathDelayMS = 1000;
var winDelayMS = 1000;
var $spriteXml = $('<TextureAtlas imagePath="sheet.png"><SubTexture name="die01.png" x="254" y="0" width="125" height="107"/><SubTexture name="die02.png" x="508" y="0" width="125" height="107"/><SubTexture name="die03.png" x="381" y="436" width="125" height="107"/><SubTexture name="die04.png" x="381" y="327" width="125" height="107"/><SubTexture name="die05.png" x="381" y="218" width="125" height="107"/><SubTexture name="die06.png" x="381" y="109" width="125" height="107"/><SubTexture name="die07.png" x="381" y="0" width="125" height="107"/><SubTexture name="die08.png" x="254" y="433" width="125" height="107"/><SubTexture name="fall.png" x="254" y="325" width="125" height="106"/><SubTexture name="idle01.png" x="254" y="217" width="125" height="106"/><SubTexture name="idle02.png" x="254" y="109" width="125" height="106"/><SubTexture name="idle03.png" x="508" y="109" width="125" height="106"/><SubTexture name="idle04.png" x="127" y="432" width="125" height="106"/><SubTexture name="jump.png" x="127" y="324" width="125" height="106"/><SubTexture name="run01.png" x="127" y="216" width="125" height="106"/><SubTexture name="run02.png" x="127" y="108" width="125" height="106"/><SubTexture name="run03.png" x="127" y="0" width="125" height="106"/><SubTexture name="run04.png" x="0" y="432" width="125" height="106"/><SubTexture name="run05.png" x="0" y="324" width="125" height="106"/><SubTexture name="run06.png" x="0" y="216" width="125" height="106"/><SubTexture name="run07.png" x="0" y="108" width="125" height="106"/><SubTexture name="run08.png" x="0" y="0" width="125" height="106"/></TextureAtlas>');
var $helmetXml = $('<TextureAtlas imagePath="sheet.png"><SubTexture name="fall.png" x="127" y="216" width="125" height="106"/><SubTexture name="idle01.png" x="381" y="0" width="125" height="106"/><SubTexture name="idle02.png" x="254" y="324" width="125" height="106"/><SubTexture name="idle03.png" x="254" y="216" width="125" height="106"/><SubTexture name="idle04.png" x="254" y="108" width="125" height="106"/><SubTexture name="jump.png" x="254" y="0" width="125" height="106"/><SubTexture name="run01.png" x="127" y="324" width="125" height="106"/><SubTexture name="run02.png" x="381" y="108" width="125" height="106"/><SubTexture name="run03.png" x="127" y="108" width="125" height="106"/><SubTexture name="run04.png" x="127" y="0" width="125" height="106"/><SubTexture name="run05.png" x="0" y="324" width="125" height="106"/><SubTexture name="run06.png" x="0" y="216" width="125" height="106"/><SubTexture name="run07.png" x="0" y="108" width="125" height="106"/><SubTexture name="run08.png" x="0" y="0" width="125" height="106"/></TextureAtlas>');
var $enemyXml = $('<TextureAtlas imagePath="sheet.png"><SubTexture name="monster1.png" x="202" y="81" width="99" height="79"/><SubTexture name="monster2.png" x="202" y="0" width="99" height="79"/><SubTexture name="monster3.png" x="101" y="162" width="99" height="79"/><SubTexture name="monster4.png" x="202" y="162" width="99" height="79"/><SubTexture name="monster5.png" x="101" y="0" width="99" height="79"/><SubTexture name="monster6.png" x="0" y="162" width="99" height="79"/><SubTexture name="monster7.png" x="0" y="81" width="99" height="79"/><SubTexture name="monster8.png" x="0" y="0" width="99" height="79"/><SubTexture name="monster9.png" x="101" y="81" width="99" height="79"/></TextureAtlas>');